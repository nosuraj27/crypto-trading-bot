<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Direct Arbitrage Bot - Live Trading</title>
    <script src="/socket.io/socket.io.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/style.css">
</head>

<body>
    <!-- Top Navigation Bar -->
    <nav class="top-nav">
        <div class="nav-container">
            <div class="nav-brand">
                <i class="fas fa-rocket"></i>
                <span>Arbitrage Bot</span>
            </div>
            <div class="nav-menu">
                <button class="nav-item active" data-page="dashboard">
                    <i class="fas fa-tachometer-alt"></i> Dashboard
                </button>
                <button class="nav-item" data-page="market">
                    <i class="fas fa-chart-line"></i> Market
                </button>
                <button class="nav-item" data-page="opportunities">
                    <i class="fas fa-search-dollar"></i> Opportunities
                </button>
                <button class="nav-item" data-page="history">
                    <i class="fas fa-history"></i> History
                </button>
                <button class="nav-item" data-page="settings">
                    <i class="fas fa-cog"></i> Settings
                </button>
            </div>
            <div class="nav-status">
                <div id="status" class="status disconnected">
                    <i class="fas fa-spinner fa-spin"></i> Connecting...
                </div>
            </div>
        </div>
    </nav>

    <div class="container">
        <!-- Dashboard Page -->
        <div id="dashboard-page" class="page active">
            <div class="header">
                <h1><i class="fas fa-rocket"></i> Direct Arbitrage Bot</h1>
                <p>Buy Low on One Exchange â†’ Sell High on Another Exchange</p>
                <div class="info-banner">
                    <small>
                        <i class="fas fa-info-circle"></i>
                        Direct Arbitrage: Buy cryptocurrency at the lowest price and sell at the
                        highest price across exchanges.
                    </small>
                </div>
            </div>

            <div class="stats-bar">
                <div class="stat-item">
                    <div class="stat-value" id="totalOpportunities">0</div>
                    <div class="stat-label">Opportunities Found</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="bestProfit">0.00%</div>
                    <div class="stat-label">Best Profit</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="activeExchanges">3</div>
                    <div class="stat-label">Active Exchanges</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="monitoredPairs">5</div>
                    <div class="stat-label">Monitored Pairs</div>
                </div>
            </div>

            <div id="opportunitiesContent" class="grid">
                <!-- <div class="spinner"><i class="fas fa-chart-line fa-spin"></i></div>
                <h2>Loading arbitrage opportunities...</h2>
                <p>Scanning exchanges for profitable trades</p> -->
            </div>
        </div>

        <!-- Market Page -->
        <div id="market-page" class="page">
            <div class="page-header">
                <h2><i class="fas fa-chart-line"></i> Live Market Prices</h2>
                <p>Real-time cryptocurrency prices across all exchanges</p>
            </div>
            <div id="marketPrices" class="market-grid">
                <!-- Dynamic market prices will be loaded here -->
            </div>
        </div>

        <!-- Opportunities Page -->
        <div id="opportunities-page" class="page">
            <div class="page-header">
                <h2><i class="fas fa-search-dollar"></i> Arbitrage Opportunities</h2>
                <p>Current profitable trading opportunities</p>
            </div>
            <div class="controls">
                <button class="btn" onclick="refreshData()">
                    <i class="fas fa-refresh"></i> Refresh
                </button>
                <button class="btn" onclick="toggleSound()">
                    <i class="fas fa-volume-up"></i> Sound Alerts
                </button>
            </div>
            <div id="opportunitiesList" class="grid">
                <!-- Opportunities will be loaded here -->
            </div>
        </div>

        <!-- History Page -->
        <div id="history-page" class="page">
            <div class="page-header">
                <h2><i class="fas fa-history"></i> Trade History</h2>
                <p>View your trading history and performance statistics</p>
            </div>

            <!-- Statistics Cards -->
            <div class="stats-grid" id="tradeStats">
                <div class="stat-card">
                    <div class="stat-icon"><i class="fas fa-chart-line"></i></div>
                    <div class="stat-content">
                        <div class="stat-value" id="totalTrades">0</div>
                        <div class="stat-label">Total Trades</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"><i class="fas fa-check-circle"></i></div>
                    <div class="stat-content">
                        <div class="stat-value" id="successfulTrades">0</div>
                        <div class="stat-label">Successful</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"><i class="fas fa-percentage"></i></div>
                    <div class="stat-content">
                        <div class="stat-value" id="successRate">0%</div>
                        <div class="stat-label">Success Rate</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"><i class="fas fa-dollar-sign"></i></div>
                    <div class="stat-content">
                        <div class="stat-value" id="totalProfit">$0.00</div>
                        <div class="stat-label">Total Profit</div>
                    </div>
                </div>
            </div>

            <!-- Filters -->
            <div class="history-filters">
                <div class="filter-group">
                    <label for="statusFilter">Status:</label>
                    <select id="statusFilter">
                        <option value="">All</option>
                        <option value="completed">Completed</option>
                        <option value="failed">Failed</option>
                        <option value="pending">Pending</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="symbolFilter">Symbol:</label>
                    <select id="symbolFilter">
                        <option value="">All Symbols</option>
                    </select>
                </div>
                <!-- <div class="filter-group">
                    <button id="refreshHistory" class="btn btn-secondary">
                        <i class="fas fa-sync-alt"></i> Refresh
                    </button>
                </div> -->
            </div>

            <!-- Trade History Table -->
            <div class="history-table-container">
                <table class="history-table" id="historyTable">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Trade ID</th>
                            <th>Symbol</th>
                            <th>Buy Exchange</th>
                            <th>Sell Exchange</th>
                            <th>Capital</th>
                            <th>Profit</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="historyTableBody">
                        <tr>
                            <td colspan="9" class="loading-row">
                                <i class="fas fa-spinner fa-spin"></i> Loading trade history...
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Pagination -->
            <div class="pagination-container" id="paginationContainer">
                <div class="pagination-info" id="paginationInfo">
                    Showing 0 - 0 of 0 trades
                </div>
                <div class="pagination-controls" id="paginationControls">
                    <button id="prevPage" class="btn btn-secondary" disabled>
                        <i class="fas fa-chevron-left"></i> Previous
                    </button>
                    <span id="pageNumbers" class="page-numbers"></span>
                    <button id="nextPage" class="btn btn-secondary" disabled>
                        Next <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Settings Page -->
        <div id="settings-page" class="page">
            <div class="page-header">
                <h2><i class="fas fa-cog"></i> Settings</h2>
                <p>Configure your arbitrage bot preferences</p>
            </div>
            <div class="settings-grid">
                <div class="settings-card">
                    <h3><i class="fas fa-dollar-sign"></i> Default Capital Amount</h3>
                    <p>Default investment amount for arbitrage trades</p>
                    <div class="input-group">
                        <input type="number" id="capitalAmount" value="100" step="10" min="10" max="10000">
                        <span>USD</span>
                    </div>
                </div>
                <div class="settings-card">
                    <h3><i class="fas fa-percentage"></i> Profit Threshold</h3>
                    <p>Minimum profit percentage to show opportunities</p>
                    <div class="input-group">
                        <input type="number" id="profitThreshold" value="0.01" step="0.001" min="0">
                        <span>%</span>
                    </div>
                </div>
                <div class="settings-card">
                    <h3><i class="fas fa-clock"></i> Update Frequency</h3>
                    <p>How often to fetch new price data</p>
                    <select id="updateFrequency">
                        <option value="5">5 seconds</option>
                        <option value="10" selected>10 seconds</option>
                        <option value="30">30 seconds</option>
                        <option value="60">1 minute</option>
                    </select>
                </div>
                <div class="settings-card">
                    <h3><i class="fas fa-broadcast-tower"></i> Broadcast Throttle</h3>
                    <p>Delay between WebSocket broadcasts (milliseconds)</p>
                    <div class="input-group">
                        <input type="number" id="broadcastThrottleMs" value="500" step="100" min="100" max="5000">
                        <span>ms</span>
                    </div>
                </div>
                <div class="settings-card">
                    <h3><i class="fas fa-list"></i> Max Trading Pairs</h3>
                    <p>Maximum number of trading pairs to monitor</p>
                    <div class="input-group">
                        <input type="number" id="maxTradingPairs" value="100" step="10" min="10" max="500">
                        <span>pairs</span>
                    </div>
                </div>
                <div class="settings-card">
                    <h3><i class="fas fa-trophy"></i> Top Pairs to Show</h3>
                    <p>Number of top opportunities to display</p>
                    <div class="input-group">
                        <input type="number" id="topPairsToShow" value="100" step="10" min="10" max="200">
                        <span>pairs</span>
                    </div>
                </div>
                <div class="settings-card">
                    <h3><i class="fas fa-bell"></i> Notifications</h3>
                    <p>Alert preferences for new opportunities</p>
                    <div class="toggle-group">
                        <label class="toggle">
                            <input type="checkbox" id="soundAlerts">
                            <span class="slider"></span>
                            Sound Alerts
                        </label>
                    </div>
                </div>
            </div>
            <div style="text-align:center; margin-top:20px;">
                <button id="submitSettings" class="btn btn-primary">
                    <i class="fas fa-save"></i> Save Settings
                </button>
            </div>
        </div>

        <div id="timestamp" class="timestamp">
            <i class="fas fa-clock"></i> <span id="timestampText">Waiting for data...</span>
        </div>
    </div>

    <!-- Load modules first -->
    <script src="/js/modules/SettingsModule.js"></script>
    <script src="/js/modules/MarketDataModule.js"></script>
    <script src="/js/modules/OpportunitiesModule.js"></script>
    <script src="/js/modules/TradeHistoryModule.js"></script>

    <!-- Load main app (can use either version) -->
    <script src="/js/app.js"></script>
</body>

</html>