<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypto Bot - Live Trading</title>
    <script src="/socket.io/socket.io.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/style.css">
</head>

<body>
    <!-- Top Navigation Bar -->
    <nav class="top-nav">
        <div class="nav-container">
            <div class="nav-brand">
                <i class="fas fa-chart-line-up"></i>
                <span>Crypto Bot</span>
            </div>

            <!-- Mobile Menu Toggle -->
            <button class="mobile-menu-toggle" id="mobileMenuToggle">
                <i class="fas fa-bars"></i>
            </button>

            <div class="nav-menu" id="navMenu">
                <button class="nav-item active" data-page="dashboard">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>Dashboard</span>
                </button>
                <button class="nav-item" data-page="market">
                    <i class="fas fa-chart-line"></i>
                    <span>Markets</span>
                </button>
                <button class="nav-item" data-page="direct-opportunities">
                    <i class="fas fa-exchange-alt"></i>
                    <span>Direct Trades</span>
                </button>
                <button class="nav-item" data-page="triangular-opportunities">
                    <i class="fas fa-project-diagram"></i>
                    <span>Triangular</span>
                </button>
                <button class="nav-item" data-page="balances">
                    <i class="fas fa-wallet"></i>
                    <span>Balances</span>
                </button>
                <button class="nav-item" data-page="history">
                    <i class="fas fa-history"></i>
                    <span>History</span>
                </button>
                <button class="nav-item" data-page="settings">
                    <i class="fas fa-cog"></i>
                    <span>Settings</span>
                </button>
            </div>

            <div class="nav-status">
                <div id="status" class="status disconnected">
                    <i class="fas fa-spinner fa-spin"></i>
                    <span>Connecting...</span>
                </div>
            </div>
        </div>
    </nav>

    <div class="container">
        <!-- Dashboard Page -->
        <div id="dashboard-page" class="page active">
            <div class="header">
                <h1><i class="fas fa-rocket"></i> Crypto Arbitrage Dashboard</h1>
                <p>Real-time arbitrage opportunities across multiple exchanges</p>
                <div class="info-banner">
                    <i class="fas fa-info-circle"></i>
                    <strong>Direct:</strong> Buy low on one exchange, sell high on another.
                    <strong>Triangular:</strong> Multi-step trades within one exchange.
                </div>
            </div>

            <!-- Quick Stats -->
            <div class="stats-bar">
                <div class="stat-item">
                    <div class="stat-icon"><i class="fas fa-search-dollar"></i></div>
                    <div class="stat-content">
                        <div class="stat-value" id="totalOpportunities">0</div>
                        <div class="stat-label">Total Opportunities</div>
                    </div>
                </div>
                <div class="stat-item">
                    <div class="stat-icon"><i class="fas fa-exchange-alt"></i></div>
                    <div class="stat-content">
                        <div class="stat-value" id="directOpportunities">0</div>
                        <div class="stat-label">Direct Arbitrage</div>
                    </div>
                </div>
                <div class="stat-item">
                    <div class="stat-icon"><i class="fas fa-project-diagram"></i></div>
                    <div class="stat-content">
                        <div class="stat-value" id="triangularOpportunities">0</div>
                        <div class="stat-label">Triangular Arbitrage</div>
                    </div>
                </div>
                <div class="stat-item">
                    <div class="stat-icon"><i class="fas fa-percentage"></i></div>
                    <div class="stat-content">
                        <div class="stat-value" id="bestProfit">0.00%</div>
                        <div class="stat-label">Best Profit</div>
                    </div>
                </div>
                <div class="stat-item">
                    <div class="stat-icon"><i class="fas fa-exchange"></i></div>
                    <div class="stat-content">
                        <div class="stat-value" id="activeExchanges">0</div>
                        <div class="stat-label">Active Exchanges</div>
                    </div>
                </div>
            </div>

            <!-- Opportunities List -->
            <div id="opportunitiesContent" class="opportunities-grid">
                <div class="loading-placeholder">
                    <i class="fas fa-spinner fa-spin"></i>
                    <p>Loading opportunities...</p>
                </div>
            </div>
        </div>

        <!-- Market Page -->
        <div id="market-page" class="page">
            <div class="page-header">
                <h2><i class="fas fa-chart-line"></i> Live Market Prices</h2>
                <p>Real-time cryptocurrency prices across all exchanges</p>
            </div>
            <div id="marketPrices" class="market-grid">
                <div class="loading-placeholder">
                    <i class="fas fa-spinner fa-spin"></i>
                    <p>Loading market data...</p>
                </div>
            </div>
        </div>

        <!-- Direct Opportunities Page -->
        <div id="direct-opportunities-page" class="page">
            <div class="page-header">
                <h2><i class="fas fa-exchange-alt"></i> Direct Arbitrage</h2>
                <p>Buy on one exchange, sell on another for instant profit</p>
            </div>

            <div id="directOpportunitiesList" class="opportunities-grid">
                <div class="loading-placeholder">
                    <i class="fas fa-spinner fa-spin"></i>
                    <p>Scanning for direct arbitrage opportunities...</p>
                </div>
            </div>
        </div>

        <!-- Triangular Opportunities Page -->
        <div id="triangular-opportunities-page" class="page">
            <div class="page-header">
                <h2><i class="fas fa-project-diagram"></i> Triangular Arbitrage</h2>
                <p>Multi-step trading within single exchange for complex profits</p>
            </div>

            <div id="triangularOpportunitiesList" class="opportunities-grid">
                <div class="loading-placeholder">
                    <i class="fas fa-spinner fa-spin"></i>
                    <p>Analyzing triangular arbitrage patterns...</p>
                </div>
            </div>
        </div>

        <!-- Balances Page -->
        <div id="balances-page" class="page">
            <div class="page-header">
                <h2><i class="fas fa-wallet"></i> Exchange Balances</h2>
                <p>View your account balances across all connected exchanges</p>
            </div>

            <div id="balancesContent" class="balances-grid">
                <div class="loading-placeholder">
                    <i class="fas fa-spinner fa-spin"></i>
                    <p>Loading exchange balances...</p>
                </div>
            </div>
        </div>

        <!-- History Page -->
        <div id="history-page" class="page">
            <div class="page-header">
                <h2><i class="fas fa-history"></i> Trade History</h2>
                <p>View your trading history and performance statistics</p>
            </div>

            <!-- Statistics Cards -->
            <div class="stats-grid" id="tradeStats">
                <div class="stat-card">
                    <div class="stat-icon"><i class="fas fa-chart-line"></i></div>
                    <div class="stat-content">
                        <div class="stat-value" id="totalTrades">0</div>
                        <div class="stat-label">Total Trades</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"><i class="fas fa-check-circle"></i></div>
                    <div class="stat-content">
                        <div class="stat-value" id="successfulTrades">0</div>
                        <div class="stat-label">Successful</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"><i class="fas fa-percentage"></i></div>
                    <div class="stat-content">
                        <div class="stat-value" id="successRate">0%</div>
                        <div class="stat-label">Success Rate</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"><i class="fas fa-dollar-sign"></i></div>
                    <div class="stat-content">
                        <div class="stat-value" id="totalProfit">$0.00</div>
                        <div class="stat-label">Total Profit</div>
                    </div>
                </div>
            </div>

            <!-- Filters -->
            <div class="history-filters">
                <div class="filter-group">
                    <label for="statusFilter">Status:</label>
                    <select id="statusFilter">
                        <option value="">All</option>
                        <option value="completed">Completed</option>
                        <option value="failed">Failed</option>
                        <option value="pending">Pending</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="symbolFilter">Symbol:</label>
                    <select id="symbolFilter">
                        <option value="">All Symbols</option>
                    </select>
                </div>
                <!-- <div class="filter-group">
                    <button id="refreshHistory" class="btn btn-secondary">
                        <i class="fas fa-sync-alt"></i> Refresh
                    </button>
                </div> -->
            </div>

            <!-- Trade History Table -->
            <div class="history-table-container">
                <table class="history-table" id="historyTable">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Trade ID</th>
                            <th>Symbol</th>
                            <th>Buy Exchange</th>
                            <th>Sell Exchange</th>
                            <th>Capital</th>
                            <th>Profit</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="historyTableBody">
                        <tr>
                            <td colspan="9" class="loading-row">
                                <i class="fas fa-spinner fa-spin"></i> Loading trade history...
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Pagination -->
            <div class="pagination-container" id="paginationContainer">
                <div class="pagination-info" id="paginationInfo">
                    Showing 0 - 0 of 0 trades
                </div>
                <div class="pagination-controls" id="paginationControls">
                    <button id="prevPage" class="btn btn-secondary" disabled>
                        <i class="fas fa-chevron-left"></i> Previous
                    </button>
                    <span id="pageNumbers" class="page-numbers"></span>
                    <button id="nextPage" class="btn btn-secondary" disabled>
                        Next <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Settings Page -->
        <div id="settings-page" class="page">
            <div class="page-header">
                <h2><i class="fas fa-cog"></i> Settings</h2>
                <p>Configure your arbitrage bot preferences</p>
            </div>
            <div class="settings-grid">
                <div class="settings-card">
                    <h3><i class="fas fa-dollar-sign"></i> Default Capital Amount</h3>
                    <p>Default investment amount for arbitrage trades</p>
                    <div class="input-group">
                        <input type="number" id="capitalAmount" value="100" step="10" min="10" max="10000">
                        <span>USD</span>
                    </div>
                </div>
                <div class="settings-card">
                    <h3><i class="fas fa-percentage"></i> Profit Threshold</h3>
                    <p>Minimum profit percentage to show opportunities</p>
                    <div class="input-group">
                        <input type="number" id="profitThreshold" value="0.01" step="0.001" min="0">
                        <span>%</span>
                    </div>
                </div>
                <div class="settings-card">
                    <h3><i class="fas fa-clock"></i> Update Frequency</h3>
                    <p>How often to fetch new price data</p>
                    <select id="updateFrequency">
                        <option value="5">5 seconds</option>
                        <option value="10" selected>10 seconds</option>
                        <option value="30">30 seconds</option>
                        <option value="60">1 minute</option>
                    </select>
                </div>
                <div class="settings-card">
                    <h3><i class="fas fa-broadcast-tower"></i> Broadcast Throttle</h3>
                    <p>Delay between WebSocket broadcasts (milliseconds)</p>
                    <div class="input-group">
                        <input type="number" id="broadcastThrottleMs" value="500" step="100" min="100" max="5000">
                        <span>ms</span>
                    </div>
                </div>
                <div class="settings-card">
                    <h3><i class="fas fa-list"></i> Max Trading Pairs</h3>
                    <p>Maximum number of trading pairs to monitor</p>
                    <div class="input-group">
                        <input type="number" id="maxTradingPairs" value="100" step="10" min="10" max="500">
                        <span>pairs</span>
                    </div>
                </div>
                <div class="settings-card">
                    <h3><i class="fas fa-trophy"></i> Top Pairs to Show</h3>
                    <p>Number of top opportunities to display</p>
                    <div class="input-group">
                        <input type="number" id="topPairsToShow" value="100" step="10" min="10" max="200">
                        <span>pairs</span>
                    </div>
                </div>
                <div class="settings-card">
                    <h3><i class="fas fa-bell"></i> Notifications</h3>
                    <p>Alert preferences for new opportunities</p>
                    <div class="toggle-group">
                        <label class="toggle">
                            <input type="checkbox" id="soundAlerts">
                            <span class="slider"></span>
                            Sound Alerts
                        </label>
                    </div>
                </div>
            </div>
            <div style="text-align:center; margin-top:20px;">
                <button id="submitSettings" class="btn btn-primary">
                    <i class="fas fa-save"></i> Save Settings
                </button>
            </div>
        </div>

        <div id="timestamp" class="timestamp">
            <i class="fas fa-clock"></i>
            <span id="timestampText">Waiting for data...</span>
        </div>
    </div>

    <!-- Mobile Menu Script -->
    <script>
        // Mobile menu toggle
        document.addEventListener('DOMContentLoaded', function () {
            const mobileMenuToggle = document.getElementById('mobileMenuToggle');
            const navMenu = document.getElementById('navMenu');

            if (mobileMenuToggle && navMenu) {
                mobileMenuToggle.addEventListener('click', function () {
                    navMenu.classList.toggle('show');
                    const icon = this.querySelector('i');
                    icon.classList.toggle('fa-bars');
                    icon.classList.toggle('fa-times');
                });
            }

            // Close mobile menu when clicking on nav items
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', () => {
                    navMenu.classList.remove('show');
                    const icon = mobileMenuToggle.querySelector('i');
                    icon.classList.add('fa-bars');
                    icon.classList.remove('fa-times');
                });
            });
        });
    </script>

    <!-- Load modules first -->
    <script src="/js/modules/NotificationModule.js"></script>
    <script src="/js/modules/SettingsModule.js"></script>
    <script src="/js/modules/MarketDataModule.js"></script>
    <script src="/js/modules/OpportunitiesModule.js"></script>
    <script src="/js/modules/TradeHistoryModule.js"></script>

    <!-- Load main app -->
    <script src="/js/app.js"></script>
</body>

</html>